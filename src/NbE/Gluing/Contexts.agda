{-# OPTIONS --without-K --safe #-}

module NbE.Gluing.Contexts {a} (ğ’° : Set a) where

data ğ’°áµ€ : Set a where
  `_` : ğ’° â†’ ğ’°áµ€
  _â‡’_ : ğ’°áµ€ â†’ ğ’°áµ€ â†’ ğ’°áµ€

infixl 5 _Â·_

data â„­ : Set a where
  ğŸ™ : â„­
  _Â·_ : â„­ â†’ ğ’°áµ€ â†’ â„­

âŸ¦_âŸ§áµ€ : âˆ€ {b} {A : Set b} â†’ ğ’°áµ€ â†’ (ğ’° â†’ A) â†’ (A â†’ A â†’ A) â†’ A
âŸ¦ ` A ` âŸ§áµ€ Î· Î¼ = Î· A
âŸ¦ A â‡’ B âŸ§áµ€ Î· Î¼ = Î¼ (âŸ¦ A âŸ§áµ€ Î· Î¼ ) (âŸ¦ B âŸ§áµ€ Î· Î¼)

âŸ¦_âŸ§á¶œ : âˆ€ {b c} {A : Set b} {B : Set c}
       â†’ â„­
       â†’ (ğ’° â†’ A)     -- base types
       â†’ (A â†’ A â†’ A) -- exponentials
       â†’ B           -- empty
       â†’ (B â†’ A â†’ B) -- extensions
       â†’ B
âŸ¦ ğŸ™     âŸ§á¶œ Î· Î¼ ğŸ˜ _âŠ•_ = ğŸ˜
âŸ¦ Î“ Â· A âŸ§á¶œ Î· Î¼ ğŸ˜ _âŠ•_ = âŸ¦ Î“ âŸ§á¶œ Î· Î¼ ğŸ˜ _âŠ•_ âŠ• âŸ¦ A âŸ§áµ€ Î· Î¼
