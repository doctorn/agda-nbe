module TDPE.Base where

data ğ’° : Set where
  â„´ : ğ’°

open import TDPE.Types public
open import TDPE.Contexts (ğ’° áµ€) public

ğ’ª : ğ’° áµ€
ğ’ª = ` â„´ `

open import Data.Nat using (â„•)
open import Data.Product using (_Ã—_; projâ‚; projâ‚‚; _,_)

ğ“âŸ¦_âŸ§áµ€ : ğ’° áµ€ â†’ Set
ğ“âŸ¦ Ï„ âŸ§áµ€ = âŸ¦ Ï„ âŸ§áµ€ (Î» _ â†’ â„•) _Ã—_ Î» A B â†’ A â†’ B

ğ“âŸ¦_âŸ§ğ’ : ğ’ â†’ Set
ğ“âŸ¦_âŸ§ğ’ = âŸ¨ ğ“âŸ¦_âŸ§áµ€ âŸ©

data ğ”—ğ”ª : ğ’ â†’ ğ’° áµ€ â†’ Set where
  -- variables
  ğ“     : âˆ€ {Î“ A} â†’ ğ”—ğ”ª (Î“ Â· A) A
  Ï€     : âˆ€ {Î“ Î” A} â†’ ğ”—ğ”ª Î“ Î” â†’ ğ”—ğ”ª (Î“ Â· A) Î”
  -- products
  fst   : âˆ€ {Î“ A B} â†’ ğ”—ğ”ª Î“ (A âŠ— B) â†’ ğ”—ğ”ª Î“ A
  snd   : âˆ€ {Î“ A B} â†’ ğ”—ğ”ª Î“ (A âŠ— B) â†’ ğ”—ğ”ª Î“ B
  â¦…_,_â¦†  : âˆ€ {Î“ A B} â†’ ğ”—ğ”ª Î“ A â†’ ğ”—ğ”ª Î“ B â†’ ğ”—ğ”ª Î“ (A âŠ— B)
  -- exponentials
  Î›     : âˆ€ {Î“ A B} â†’ ğ”—ğ”ª (Î“ Â· A) B â†’ ğ”—ğ”ª Î“ (A â‡’ B)
  _â¦…_â¦†   : âˆ€ {Î“ A B} â†’ ğ”—ğ”ª Î“ (A â‡’ B) â†’ ğ”—ğ”ª Î“ A â†’ ğ”—ğ”ª Î“ B
  -- literals
  ğ“     : âˆ€ {Î“ A} â†’ ğ“âŸ¦ A âŸ§áµ€ â†’ ğ”—ğ”ª Î“ A

ğ“âŸ¦_âŸ§ : âˆ€ {Î“ A} â†’ ğ”—ğ”ª Î“ A â†’ ğ“âŸ¦ Î“ âŸ§ğ’ â†’ ğ“âŸ¦ A âŸ§áµ€
ğ“âŸ¦ ğ“           âŸ§ âŸ¨ _ âˆ· a âŸ© = a
ğ“âŸ¦ Ï€ t         âŸ§ âŸ¨ Î¸ âˆ· _ âŸ© = ğ“âŸ¦ t âŸ§ Î¸
ğ“âŸ¦ fst t       âŸ§ Î¸         = projâ‚ (ğ“âŸ¦ t âŸ§ Î¸)
ğ“âŸ¦ snd t       âŸ§ Î¸         = projâ‚‚ (ğ“âŸ¦ t âŸ§ Î¸)
ğ“âŸ¦ â¦… tâ‚ , tâ‚‚ â¦† âŸ§ Î¸         = ğ“âŸ¦ tâ‚ âŸ§ Î¸ , ğ“âŸ¦ tâ‚‚ âŸ§ Î¸
ğ“âŸ¦ Î› t         âŸ§ Î¸         = Î» x â†’ ğ“âŸ¦ t âŸ§ âŸ¨ Î¸ âˆ· x âŸ©
ğ“âŸ¦ f â¦… x â¦†     âŸ§ Î¸         = ğ“âŸ¦ f âŸ§ Î¸ (ğ“âŸ¦ x âŸ§ Î¸)
ğ“âŸ¦ ğ“ l         âŸ§ Î¸         = l

+ğ”—ğ”ª : âˆ€ A â†’ ğ’²+ (Î» Î“ â†’ ğ”—ğ”ª Î“ A)
+ğ”—ğ”ª _ Ïµâ‚€     t          = t
+ğ”—ğ”ª _ (Ï‰â‚ w) ğ“          = Ï€ (+ğ”—ğ”ª _ w ğ“)
+ğ”—ğ”ª _ (Ï‰â‚‚ w) ğ“          = ğ“
+ğ”—ğ”ª _ (Ï‰â‚ w) (Ï€ t)      = Ï€ (+ğ”—ğ”ª _ w (Ï€ t))
+ğ”—ğ”ª _ (Ï‰â‚‚ w) (Ï€ t)      = Ï€ (+ğ”—ğ”ª _ w t)
+ğ”—ğ”ª _ w      (fst t)    = fst (+ğ”—ğ”ª _ w t)
+ğ”—ğ”ª _ w      (snd t)    = snd (+ğ”—ğ”ª _ w t)
+ğ”—ğ”ª _ w      â¦… tâ‚ , tâ‚‚ â¦† = â¦… +ğ”—ğ”ª _ w tâ‚ , +ğ”—ğ”ª _ w tâ‚‚ â¦†
+ğ”—ğ”ª _ w      (Î› t)      = Î› (+ğ”—ğ”ª _ (Ï‰â‚‚ w) t)
+ğ”—ğ”ª _ w      (f â¦… x â¦†)  = +ğ”—ğ”ª _ w f â¦… +ğ”—ğ”ª _ w x â¦†
+ğ”—ğ”ª _ w      (ğ“ l)      = ğ“ l

+ğ“ : âˆ€ {Î“ Î”} â†’ ğ’² Î“ Î” â†’ ğ“âŸ¦ Î“ âŸ§ğ’ â†’ ğ“âŸ¦ Î” âŸ§ğ’
+ğ“ Ïµâ‚€     Î¸         = Î¸
+ğ“ (Ï‰â‚ w) âŸ¨ Î³ âˆ· _ âŸ© = +ğ“ w Î³
+ğ“ (Ï‰â‚‚ w) âŸ¨ Î³ âˆ· a âŸ© = âŸ¨ +ğ“ w Î³ âˆ· a âŸ©
